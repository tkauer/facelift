<!DOCTYPE html>
<html>
<head>
	<title>Facelift</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"/>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">

    <!-- D3 -->
    <script src="js/d3.v4.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>

    <!--Leaflet + Heatmap -->
    
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
    <script src="js/simpleheat.js"></script>
    <script src="js/HeatLayer.js"></script>

    <!-- Own scripts -->
	
    <script src="js/comparison.js"></script>
    <script src="js/labels.js"></script>
    <script src="js/map.js"></script>
    <script src="js/parse.js"></script>    
    <!--<script src="js/labelBeauty.js"></script>    
    <script src="js/reverseLookup.js"></script>  
    <script src="js/metricComparison.js"></script> -->
    <script>
    	$(document).on('click', '.intro a[href^="#"]', function (event) {
    		event.preventDefault();
		    $('html, body').animate({
		        scrollTop: $($.attr(this, 'href')).offset().top
		    }, 500);
		});

		$(document).on('click', 'span.closer', function (event) {
			  $(this).parent().parent().hide();
		});
    </script>
</head>
<body>
	<div id="overlay">
		<div class="comparison"> 
			<span class="closeOverlay" style="z-index: 99">X</span>
			<div class="container-fluid">
				<div class="prevLocation"><svg width=30 height=30>
					<circle r=15 cx=15 cy=15 fill="grey" />
					<polygon points="17,10 17,20 10,15" fill="black"/>
				</svg></div>
				<div class="nextLocation"><svg width=30 height=30>
					<circle r=15 cx=15 cy=15 fill="grey" />
					<polygon points="12,10 12,20 20,15" fill="black" />
				</svg></div>
				<div class="row">
					<div class="col-12 description">
						<div class="helper" style="z-index: 20; top: 80px; left: -50px;"><div>Move your mouse over the images to see how they have changed. <span class="closer">Got it!</span></div><img src="img/helper2.png" / style="margin-left: 50px"></div>
						<p><span class="key"></span><br><strong>How has this location changed?</strong></p>
					</div>
				</div>
				<div class="row images">
					<div class="col-6 c1"></div>
					<div class="col-6 c2"></div>
				</div>
				<div class="row">
					<div class="col-12 labelList"></div>
				</div>
				<div class="row">
					<div class="col-6">
						<div class="radarChart"></div>
						<p style="text-align: center;">The five Urban Design Metrics indicate, how livable the <span style="font-weight: bold; color: #F93A02;">original place</span> and its <span style="font-weight: bold; color: #08B3F7;">beautified alternative</span> are.</p>
					</div>
					<div class="col-6">
						<div class="segnetChart"></div>
						<p style="text-align: center;">The Segnet analysis shows, what you can actually see in the pictures.</p>
					</div>
				</div>
			</div>
		</div>
	</div>


	<div class="container-fluid">
		<div class="row">
			<div class="col-12">
				<div class="intro">
					<h1><img src="img/facelift.png" alt="facelift" /></h1>
					<p><strong>Can <i>Machine Learning</i> tell us, how  future cities will look like?</strong> Probably not! But it can help to analzye urban imagery at scale and help us to explore spatial patterns of beauty.</p>
					<p>Facelift is a Deep Neural Network, that generates more beautiful versions of a given location. By Mapping and comparing these images and their metadata, we ca get a grasp of the networks understanding of urban aesthetics.</p>
					 <a href="#start">Explore Boston with FACELIFT</a>
				</div>
			</div>
		</div>
		<div class="row" id="start">
			
			<div class="col-8">
				<div class="helper" style="top: 200px; left: 200px;"><div>Drag and Drop the map to explore Boston. Click on circled items to show details. <span class="closer">Got it!</span></div><img src="img/helper2.png" / style="margin-left: 50px"></div>
				<div id="map"></div>
			</div>
			<div class ="col-4">
				<div class="helper" style="top: 10px; right: 100px;"><div>Hover over the labels below to see, where in Boston you can find them. Click a label to see it permanently. <span class="closer">got it!</span></div><img src="img/helper.png" / style="float: right; margin-right: 20px"></div>
				<p style="padding: 20px 0 0 10px; margin-bottom: 5px">For Boston, 59 relevant sceneries were detected, ranging from <span style="font-weight: bold; color: #08B3F7;">beautiful</span> to <span style="font-weight: bold; color: #F93A02;">ugly</span>: The bigger the label, the more often it appears.</p>
				<div id="labels"></div>
				<!--<div class="btn-group" role="group" aria-label="Basic example">
				  <button type="button" class="btn btn-secondary" onclick="createList(getLabelList()); circleLayer.clearLayers();">Explore Labels</button>
				  <button type="button" class="btn btn-secondary" onclick="reverseLookup();">Explore Map</button>
				</div>-->
				<div>
					<svg>
						<g transform="translate(0,10)">
							<circle r=6 fill="#36657E" cx=20></circle>
							<text x=40 y=4 fill="#d2d2d2">more beautiful locations</text>
						</g>
						<g transform="translate(0,33)">
							<circle r=9 fill="#993014" cx=20></circle>
							<text x=40 y=4 fill="#d2d2d2">uglier locations</text>
						</g>
						<g transform="translate(0,60)">
							<circle r=11 fill="#993014" stroke="#fff" stroke-width=1 cx=20></circle>
							<text x=40 y=4 fill="#d2d2d2">click location to compare</text>
						</g>
					</svg>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-12">
				<div class="labelBeauty" style="width: 80%; margin:0 auto"></div>
			</div>
		</div>
		<div class="row">
			<div class="col-12">
				<div class="metricComparison"></div>
			</div>
		</div>
	</div>
	
	
	<script type="text/javascript">
    //some global variables
    var labels = {},
    	sortedLabels, 
    	hotLabels = [],
    	combinations,
    	segnetMinMax,
    	map = L.map('map').setView([42.3488, -71.07702], 13),
    	heat = L.heatLayer,
    	circleLayer = L.layerGroup({interactive: false}).addTo(map);

    L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> Contributors', maxZoom: 18,}).addTo(map);
		
	//pre-load all necessary json files, then run init()
    queue().defer(d3.json, 'data/BostonCollatedV2.json').await(init);

	function init(error, collatedJson,) {
		labels = parseLabels(collatedJson); //useful to make this global
		sortedLabels = getLabelList(labels,5);
		showLabelsOnMap(labels);
		
		combinations = parseCombinations(collatedJson);
		globalSegnetMinMax = segnetMinMax(combinations); 

		showCombinationsOnMap(globalSegnetMinMax);
		createList(sortedLabels);
		//openComparison(combinations["513d6c7ffdc9f03587004fa3"], segnetMinMax);
		//reverseLookup(trueSkillCoordinates);
		//drawMetricComparison();
		//labelBeauty();

		
	} 
	
	</script>
</body>
</html>